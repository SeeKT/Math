\documentclass[dvipdfmx]{jsreport}
\input{../preamble.tex}
\begin{document}
\chapter{証明}
この章には，補題や定理の証明(一部)を記載する．
\section{2章の証明}
\begin{proof}[補題\ref{lemm:convex}の証明]
  項が2つのとき，つまり，$X_1, X_2 \subseteq \mathbb{R}^n$が凸集合ならば，$X_1 \cap X_2$も凸集合である(*)
  を証明する．$\forall \bm{x}^1, \bm{x}^2 \in X_1 \cap X_2$に対し，$\bm{x}^1$と$\bm{x}^2$を結ぶ線分は，$\bm{x}^1 \in X_1, \bm{x}^2 \in X_1$より$X_1$に含まれる($\because$ $X_1$は凸集合)．同様に$X_2$にも含まれる．
  よって，$\bm{x}^1$と$\bm{x}^2$を結ぶ線分は，$X_1 \cap X_2$に含まれる．つまり，$X_1 \cap X_2$は凸集合である．補題\ref{lemm:convex}は，(*)を繰り返し用いることで示される．\qed
\end{proof}

補題\ref{lemm:hyperplane1}の証明には，定理\ref{theo:projection}，補題\ref{lemm:proj}を用いる．

\begin{theo}[射影定理]\label{theo:projection}
  $X$をHilbert空間\footnote{距離(ノルム)を持つ集合をノルム空間という．内積を持つ線形空間を内積空間という．ノルム空間$X$内の任意のコーシー列が収束するとき，$X$は完備であるといい，完備性を持つノルム空間$X$をBanach空間という．また，内積空間$X$上の点$\bm{u} \in X$に対し，$\|\bm{u}\| = \sqrt{(\bm{u}, \bm{u})}$を内積から誘導されるノルムと呼ぶ．内積から誘導されるノルム空間$X$がBanach空間であるとき，$X$をHilbert空間という．実数空間$\mathbb{R}^n$は完備性を持つ．}とし，$L \subset X$を閉部分空間とする．このとき，
  \begin{equation}
    \bm{u} \in X \, (\mathrm{given}) \Rightarrow \exists! \bm{v} \in L \; s.t. \; (\bm{u} - \bm{v}, \bm{w}) = 0, \, \forall \bm{w} \in L \nonumber
  \end{equation}
  が成立する(射影が一意に存在する)．
\end{theo}

\begin{lemm}\label{lemm:proj}
    定理\ref{theo:projection}の$X$が$X = \mathbb{R}^n$であり，$L \subseteq \mathbb{R}^n$が空でない閉凸集合とする．$\bm{u} \in \mathbb{R}^n$の$L$への射影を$\bm{v}$とする．このとき，$\forall \bm{w} \in L$に対して，
  \begin{equation}\label{eq:proj}
    (\bm{u} - \bm{v})^{\mathrm{T}} (\bm{w} - \bm{v}) \leq 0
  \end{equation}
  が成立する．
\end{lemm}


\begin{proof}[補題\ref{lemm:proj}の証明]
  $\bm{u}$の$L$への射影$\bm{v}$と任意の点$\bm{w} \in L$を結ぶ線分上の点
  $\bm{x}_{\lambda} = (1 - \lambda)\bm{v} + \lambda \bm{w}, \, 0 < \lambda < 1$
  を考える．$L$は凸より，$\bm{x}_{\lambda}$も$L$に含まれる．
  $\bm{v}$の定義より，
  \begin{equation}\label{eq:prj_min}
    \|\bm{v} - \bm{u}\|^2 \leq \|((1 - \lambda)\bm{v} + \lambda \bm{w}) - \bm{u} \|^2
  \end{equation}
  (\ref{eq:prj_min})式を整理すると，
  \begin{align}
    (\bm{v}- \bm{u}, \bm{v}- \bm{u}) &\leq \|(\bm{v} - \bm{u}) + \lambda(\bm{w} - \bm{v}) \|^2 \nonumber \\
    &\leq (\bm{v}- \bm{u}, \bm{v}- \bm{u}) + 2\lambda(\bm{v} - \bm{u})(\bm{w} - \bm{v}) + \lambda^2(\bm{w} - \bm{v}, \bm{w} - \bm{v}) \nonumber
  \end{align}
  いま，$\lambda \neq 0, \lambda > 0$であり，$L \subseteq \mathbb{R}^n$であるから，
  \begin{equation}
    2(\bm{u} - \bm{v})(\bm{w} - \bm{v}) \leq \lambda \|\bm{w} - \bm{v}\|^2 \nonumber
  \end{equation}
  よって，$\lambda \rightarrow 0$とすると，(\ref{eq:proj})式を得る．\qed
\end{proof}

\begin{proof}[補題\ref{lemm:hyperplane1}の証明]
  $\bm{y} \in \mathbb{R}^n$の$X$への射影を$\bar{\bm{y}}$とする．定理\ref{theo:projection}より，$\bar{\bm{y}}$は$\bm{y}$に対して一意に存在する．$\bm{y} \notin X$より，$\bm{y} \neq \bar{\bm{y}}$である．
  よって，
  \begin{equation}\label{eq:norm}
    \|\bar{\bm{y}} - \bm{y}\|^2 = (\bar{\bm{y}} - \bm{y})^{\mathrm{T}}(\bar{\bm{y}} - \bm{y}) > 0
  \end{equation}
  である．また，補題\ref{lemm:proj}より，
  \begin{equation}\label{eq:prj}
    (\bm{y} - \bar{\bm{y}})^{\mathrm{T}}(\bm{x} - \bar{\bm{y}}) \leq 0, \; x \in X
  \end{equation}
  が成立する．(\ref{eq:norm})式，(\ref{eq:prj})式より，
  \begin{equation}
    (\bar{\bm{y}} - \bm{y})^{\mathrm{T}} \bm{x} \geq (\bar{\bm{y}} - \bm{y})^{\mathrm{T}} \bar{\bm{y}} > (\bar{\bm{y}} - \bm{y})^{\mathrm{T}} \bm{y}, \; x \in X \nonumber
  \end{equation}
  を得る．ここで，$\bm{a} = \bar{\bm{y}} - \bm{y}, \, b = (\bar{\bm{y}} - \bm{y})^{\mathrm{T}} \bar{\bm{y}}$と置くと，$\bar{\bm{y}}$の一意性より補題\ref{lemm:hyperplane1}が示される．\qed
\end{proof}

\begin{proof}[補題\ref{lemm:hyperplane2}の証明]
  $\bm{y}$は$X$の内点でないので，$\bm{y}$の近傍
  $B_k = \{\bm{x} \in \mathbb{R}^n \, | \, \|\bm{x} - \bm{y}\| < \varepsilon_k\}$
  はある点$\bm{x}^k \notin \mathrm{Cl}(X)$を含む．
  $k \rightarrow \infty$に伴い，$\varepsilon_k \rightarrow 0$とすると，
  点列$\{\bm{x}^k\}$は$\mathrm{Cl}(X)$の外部から$\bm{y}$に収束する．
  $\bm{x}^k \notin \mathrm{Bd}(X)$から，補題\ref{lemm:hyperplane1}より
  \begin{equation}
    (\bm{a}^k)^{\mathrm{T}} \bm{x} > (\bm{a}^k)^{\mathrm{T}} \bm{x}^k, \, \forall \bm{x} \in X \nonumber
  \end{equation}
  なる$\bm{a}^k \in \mathbb{R}^n$が存在する．$\bm{a}^k \neq \bm{0}$より，$\|\bm{a}^k\| = 1$を仮定する．
  点列$\{\bm{a}^k\}$の極限点を$\bm{a}$とすると，
  \begin{equation}
    \bm{a}^{\mathrm{T}} \bm{x} \geq \bm{a}^{\mathrm{T}} \bm{y}, \, \forall \bm{x} \in X \nonumber
  \end{equation}
  である．$\|\bm{a}\| = 1$より，$\bm{a} \neq \bm{0}$である．\qed
\end{proof}

\begin{proof}[補題\ref{lemm:hyperplane3}の証明]
  集合$X, Y$から集合$S = \{\bm{z} \in \mathbb{R}^n \, | \, \bm{z} = \bm{x} - \bm{y}, \, \bm{x} \in X, \bm{y} \in Y\}$
  を定義すると，$S$も凸集合である\footnote{2点$\bm{z}^1 = \bm{x}^1 - \bm{y}^1, \bm{z}^2 = \bm{x}^2 - \bm{y}^2 \in S, \; \bm{x}^1, \bm{x}^2 \in X, \bm{y}^1, \bm{y}^2 \in Y$
  を結ぶ線分上の点を考えると，
  \begin{align}
    (1 - \lambda)\bm{z}^1 + \lambda\bm{z}^2 &= (1 - \lambda)(\bm{x}^1 - \bm{y}^1) + \lambda(\bm{x}^2 - \bm{y}^2) \nonumber \\
    &= ((1 - \lambda)\bm{x}^1 + \lambda\bm{x}^2) - ((1 - \lambda)\bm{y}^1 + \lambda\bm{y}^2) \nonumber
  \end{align}
  と書けるため，$X$と$Y$の凸性より，やはり$S$に属するから．
  }．
  $X \cap Y = \emptyset$より，$\bm{0}$ベクトルは$\bm{0} \notin S$である．
  補題\ref{lemm:hyperplane1}，補題\ref{lemm:hyperplane2}より，
  \begin{equation}
    \bm{a}^{\mathrm{T}} \bm{z} \geq \bm{0}, \, \forall \bm{z} \in S \nonumber
  \end{equation}
  を満たす$\bm{a} \neq \bm{0}$が存在する．よって，$S$の定義より，
  \begin{equation}
    \bm{a}^{\mathrm{T}}\bm{x} \geq \bm{a}^{\mathrm{T}}\bm{y}, \, \forall \bm{x} \in X, \forall \bm{y} \in Y \nonumber
  \end{equation}
  を得る．よって，$b = \inf_{\bm{x} \in X} \bm{a}^{\mathrm{T}}\bm{x}$とおくと，(\ref{eq:hyperplane3})式を得る．\qed
\end{proof}

\section{4章の証明}
\begin{proof}[定理\ref{theo:opt_nonl_nonc_h_1}の証明]
  $\bm{d} \in \mathbb{R}^n, \, \varepsilon > 0$を考える．$\varepsilon$が十分小さければ，局所最適性より，
  \begin{equation}
    f(\bar{\bm{x}} + \varepsilon \bm{d}) \geq f(\bar{\bm{x}}), \; f(\bar{\bm{x}} - \varepsilon \bm{d}) \geq f(\bar{\bm{x}}) \nonumber
  \end{equation}
  が成立する．Taylorの定理より，
  \begin{align}
    f(\bar{\bm{x}} + \varepsilon \bm{d}) &= f(\bar{\bm{x}}) + \varepsilon \nabla f(\bar{\bm{x}})^{\mathrm{T}}\bm{d} + o(\varepsilon\|\bm{d}\|) \geq f(\bar{\bm{x}}) \nonumber \\
    f(\bar{\bm{x}} - \varepsilon \bm{d}) &= f(\bar{\bm{x}}) - \varepsilon \nabla f(\bar{\bm{x}})^{\mathrm{T}}\bm{d} + o(\varepsilon\|\bm{d}\|) \geq f(\bar{\bm{x}}) \nonumber
  \end{align}
  なので，
  \begin{equation}
    |\nabla f(\bar{\bm{x}})\bm{d}| = \frac{o(\varepsilon \|\bm{d}\|)}{\varepsilon} \rightarrow 0 \; (\varepsilon \rightarrow 0) \nonumber
  \end{equation}
  より，$\nabla f(\bar{\bm{x}}) = 0$ \qed
\end{proof}

\begin{proof}[定理\ref{theo:opt_nonl_nonc_h_2}の証明]
  定理\ref{theo:opt_nonl_nonc_h_1}より，$\nabla f(\bar{\bm{x}}) = 0$．任意の$\bm{d} \in \mathbb{R}^n, \, \varepsilon > 0$に対して，
  \begin{equation}
    f(\bar{\bm{x}} + \varepsilon \bm{d}) \geq f(\bar{\bm{x}}) \; (\because \bar{\bm{x}}が局所最適解)\nonumber
  \end{equation}
  Taylorの定理と$\nabla f(\bar{\bm{x}}) = 0$より，
  \begin{equation}
    \frac{1}{2} \bm{d}^{\mathrm{T}} {\nabla}^2 f(\bar{\bm{x}}) \bm{d} + \frac{o({\varepsilon}^2 \|\bm{d}\|^2)}{{\varepsilon}^2} \geq 0 \nonumber
  \end{equation}
  が成立する．よって，$\varepsilon \rightarrow 0$として$\bm{d}^{\mathrm{T}} H(\bar{\bm{x}}) \bm{d} \geq 0$を得る．\qed
\end{proof}

\begin{proof}[定理\ref{theo:opt_nonl_nonc_j}の証明]
  $f(\bar{\bm{x}} + \varepsilon \bm{d})$に対して，Taylorの定理より，
  \begin{equation}
    f(\bar{\bm{x}} + \varepsilon \bm{d}) - f(\bar{\bm{x}}) = \varepsilon \nabla f(\bar{\bm{x}})^{\mathrm{T}}\bm{d} + \frac{{\varepsilon}^2}{2} \bm{d}^{\mathrm{T}} {\nabla}^2 f(\bar{\bm{x}}) \bm{d} + o({\varepsilon}^2 \|\bm{d}\|^2) \nonumber
  \end{equation}
  $\nabla f(\bar{\bm{x}}) = 0$を代入し，両辺を${\varepsilon}^2$で割ると，右辺は，
  \begin{equation}\label{eq:onnj}
    \frac{1}{2} \bm{d}^{\mathrm{T}} {\nabla}^2 f(\bar{\bm{x}}) \bm{d} + \frac{o({\varepsilon}^2 \|\bm{d}\|^2)}{{\varepsilon}^2}
  \end{equation}
  $H(\bar{\bm{x}})$が正定値であり，$\varepsilon \rightarrow 0$であれば，第二項は$0$に収束する．
  よって，$\varepsilon$が十分小さく，$\varepsilon \neq 0$であれば，(\ref{eq:onnj})式は正となる．
  $\varepsilon = 0$を含めて，
  $f(\bar{\bm{x}} + \varepsilon \bm{d}) \geq f(\bar{\bm{x}})$が成立する．つまり，$\bar{\bm{x}}$は局所最適解である．\qed
\end{proof}

\begin{proof}[定理\ref{theo:opt_nonl_eq_h}の証明]

(1次の必要条件)

ペナルティ関数$F^k(\bm{x})$に関する議論により，(\ref{eq:opt_penal_non})の局所最適解$\bm{x}^k$に定理\ref{theo:opt_nonl_nonc_h_1}を適用できる．
\begin{align}
  &F^k(\bm{x}) = f(\bm{x}) + \frac{k}{2} \|g(\bm{x})\|^2 + \frac{\alpha}{2} \|\bm{x} - \bar{\bm{x}}\|^2 \nonumber \\
  &g(\bm{x}) = (g_1(\bm{x}), \ldots, g_m(\bm{x}))^{\mathrm{T}} \nonumber
\end{align}
より，
\begin{equation}\label{eq:nabFk}
  \nabla F^k(\bm{x}^k) = \nabla f(\bm{x}^k) + k \nabla g(\bm{x}^k)^{\mathrm{T}} g(\bm{x}^k) + \alpha (\bm{x} - \bar{\bm{x}}) = 0
\end{equation}
を得る．$\bar{\bm{x}}$は正則であるから，$k$が十分大きければ$\bm{x}^k$も正則．よって，
\begin{equation}
  \mathrm{rank}(\nabla g(\bm{x}^k)^{\mathrm{T}}) = m, \; \mathrm{rank}(\nabla g(\bm{x}^k)) = m \nonumber
\end{equation}
が成立する．よって，$m$次正方行列$\nabla g(\bm{x}^k) \nabla g(\bm{x}^k)^{\mathrm{T}}$も正則である．(\ref{eq:nabFk})の両辺に左から$(\nabla g(\bm{x}^k) \nabla g(\bm{x}^k)^{\mathrm{T}})\nabla g(\bm{x}^k)$を乗じて整理すると，
\begin{equation}
  k g(\bm{x}^k) = -(\nabla g(\bm{x}^k) \nabla g(\bm{x}^k)^{\mathrm{T}})^{-1} \nabla g(\bar{\bm{x}})(\nabla f(\bm{x}^k) + \alpha (\bm{x} - \bar{\bm{x}})) \nonumber
\end{equation}
を得る．$k \rightarrow \infty$とすると，$\{\bm{x}^k\}$は$\bar{\bm{x}}$に収束するので，点列$\{k g(\bm{x}^k)\}$は，$m$次元ベクトル
\begin{equation}
  \bm{u} = -(\nabla g(\bm{x}^k) \nabla g(\bm{x}^k)^{\mathrm{T}})^{-1} \nabla g(\bar{\bm{x}}) \nabla f(\bar{\bm{x}}) \nonumber
\end{equation}
に収束する．(\ref{eq:nabFk})において，$k \rightarrow \infty$とすると，
\begin{equation}
  \nabla f(\bar{\bm{x}}) + \nabla g(\bar{\bm{x}})^{\mathrm{T}} \bm{u} = \bm{0} \nonumber
\end{equation}
を得る．\qed

(2次の必要条件)

(\ref{eq:opt_penal_non})の局所最適解$\bm{x}^k$に定理\ref{theo:opt_nonl_nonc_h_2}を適用できる．
\begin{equation}
  \nabla^2 F^k(\bm{x}^k) = \nabla^2 f(\bm{x}^k) + k \nabla g(\bm{x}^k)^{\mathrm{T}} \nabla g(\bm{x}^k) + k \sum_{i = 1}^m g_i(\bm{x}^k) \nabla^2 g_i(\bm{x}^k) + \alpha I \nonumber
\end{equation}
は半正定値である．ただし，$I$は単位行列を示す．$\bm{y} \in V(\bar{\bm{x}})$を任意に選び，これに基づき，
\begin{equation}\label{eq:yk}
  \bm{y}^k = \bm{y} - \nabla g(\bm{x}^k)^{\mathrm{T}} (\nabla g(\bm{x}^k)\nabla g(\bm{x}^k)^{\mathrm{T}})^{-1} \nabla g(\bm{x}^k) \bm{y}
\end{equation}
とする．$\bm{y}^k$は，
\begin{equation}
  \nabla g(\bm{x}^k) \bm{y}^k = \bm{0} \nonumber
\end{equation}
を満たす\footnote{$\bm{y}^k$は$y$の空間$V(\bm{x}^k)$への射影点である．}．
$k \rightarrow \infty$とすると，$\bm{x}^k \rightarrow \bar{\bm{x}}$であり，$\bm{y}$の定義より，$\nabla g(\bar{\bm{x}}) = \bm{0}$である．よって，(\ref{eq:yk})の第二項は$\bm{0}$に収束し，$\bm{y}^k \rightarrow \bm{y}$を得る．

次に，$\nabla^2 F^k(\bm{x}^k)$の半正定値性と$\nabla g(\bm{x}^k)\bm{y}^k = \bm{0}$を用いて，
\begin{equation}
  (\bm{y}^k)^{\mathrm{T}} \nabla^2 F^k(\bm{x}^k) \bm{y}^k = (\bm{y}^k)^{\mathrm{T}} \left(\nabla^2 f(\bm{x}^k) + k \sum_{i = 1}^m g_i(\bm{x}^k) \nabla^2 g_i(\bm{x}^k) \right) \bm{y}^k + \alpha \|\bm{y}^k\|^2 \geq 0 \nonumber
\end{equation}
を得る．
$k \rightarrow \infty$とすると，
\begin{equation}
  \bm{y}^k \rightarrow \bm{y}, \; \bm{x}^k \rightarrow \bar{\bm{x}}, \; kg_i(\bm{x}^k) \rightarrow u_i \nonumber
\end{equation}
となる．よって，
\begin{equation}
 (\bm{y})^{\mathrm{T}} \left(\nabla^2 f(\bar{\bm{x}}) + \sum_{i = 1}^m u_i \nabla^2 g_i(\bar{\bm{x}}) \right) \bm{y} + \alpha \|\bm{y}\|^2 \geq 0, \; \forall \bm{y} \in V(\bar{\bm{x}}) \nonumber
\end{equation}
となる．$\alpha > 0$は任意より，$\alpha \rightarrow 0$として，(\ref{eq:opt_nonl_eq_h_2})を得る．\qed
\end{proof}

\begin{proof}[定理\ref{theo:convex_problem}の証明]
  局所最適解$\bm{x}^{\prime}$が大域最適解ではなく，それとは異なる大域最適解$\bar{\bm{x}}$が存在したとする．このとき，$f(\bar{\bm{x}}) < f(\bm{x}^{\prime})$を満たす．$\bm{x}^{\prime}$の任意の近傍$B$と$\bm{x}^{\prime}$と$\bar{\bm{x}}$を結ぶ線分上の点
  $\bm{x}_{\alpha} =  (1 - \alpha)\bm{x}^{\prime} + \alpha \bar{\bm{x}}, \, 0 \leq \alpha \leq 1$を考えると，
  実行可能領域の凸性より，$\bm{x}_{\alpha}$も実行可能解である．
  十分小さな$\alpha > 0$では，$\bm{x}_{\alpha} \in B$が成立する．$f$の凸性より，
  \begin{equation}
    f(\bm{x}_{\alpha}) \leq (1 - \alpha)f(\bm{x}^{\prime}) + \alpha f(\bar{\bm{x}}) < f(\bm{x}^{\prime}) \nonumber
  \end{equation}
  である．これは，$\bm{x}^{\prime}$が局所最適解であることに矛盾する．

  $f$が狭義凸関数であるとし，異なる大域最適解$\bar{\bm{x}}, \bar{\bar{\bm{x}}}$が存在することを仮定する．このとき，$f(\bar{\bm{x}}) = f(\bar{\bar{\bm{x}}})$である．
  $\bar{\bm{x}}$と$\bar{\bar{\bm{x}}}$を結ぶ線分上の点
  $\bm{x}_{\alpha} = (1 - \alpha)\bar{\bm{x}} + \alpha \bar{\bar{\bm{x}}}, \, 0 < \alpha < 1$を考えると，実行可能領域の凸性より，$\bm{x}_{\alpha}$も実行可能解．$f$の狭義凸性より，
  \begin{equation}
    f(\bm{x}_{\alpha}) < (1 - \alpha)f(\bar{\bm{x}}) + \alpha f(\bar{\bar{\bm{x}}}) = f(\bar{\bm{x}}) \nonumber
  \end{equation}
  これは，$\bar{\bm{x}}$が大域最適解であることに矛盾する．\qed
\end{proof}

\end{document}
