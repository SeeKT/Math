\documentclass{jsreport}
\input{../preamble.tex}
\begin{document}

\chapter{線形計画問題}
本章では，線形計画問題の定式化，最適性，およびアルゴリズムについて述べる．
\section{線形計画問題の例}
線形計画問題の例として，しばしば生産計画問題が挙げられる．例えば，次のような問題である．
\begin{description}
  \item[生産計画問題]
  A社では，2種類の製品$P_1, \, P_2$を同じ原料から生産している．$P_1$ 1トン生産するのに要する原料は2.5トン，電力は5kwh，労力は3人時，$P_2$ 1トン生産するのに要する原料は5トン，電力は6kwh，労力は2人時である．1日の原料，電力，労力の使用可能量は，それぞれ350トン，450kwh，240人時である．$P_1, \, P_2$ 1トン当たりの粗利益は，それぞれ，4万円，5万円である．このとき，総粗利益を最大にするには，$P_1, \, P_2$を何トンずつ生産すればよいか．
\end{description}

$P_1, \, P_2$の1日の生産量(トン)をそれぞれ$x_1, \, x_2$とする．この問題は表\ref{tab:product_plan}のように表される．
\begin{table}[htb]
  \centering
    \caption{生産計画問題}
    \begin{tabular}{c|c|c|c}
       & $P_1$ & $P_2$ &  \\ \hline
      原料 & $2.5x_1$ & $5x_2$ & $350$ \\ \hline
      電力 & $5x_1$ & $6x_2$ & $450$ \\ \hline
      労力 & $3x_1$ & $2x_2$ & $240$ \\ \hline
      粗利益 & $4x_1$ & $5x_2$ & \\
    \end{tabular}
    \label{tab:product_plan}
\end{table}

以上より，この生産計画問題は次の線形計画問題となる．
\begin{align}\label{eq:product_plan}
  \mathrm{maximize} \; \; &4x_1 + 5x_2 \nonumber \\
  \mathrm{subject \; to} \; \; &2.5x_1 + 5x_2 \leq 350 \nonumber \\
  &5x_1 + 6x_2 \leq 450 \\
  &3x_1 + 2x_2 \leq 240 \nonumber \\
  &x_1, x_2 \geq 0 \nonumber
\end{align}

\section{線形計画問題の最適解}
\ref{sec:convex_prob}節で述べたように，線形計画問題の実行可能領域は凸多面体であり，目的関数も線形(凸関数)であるので，線形計画問題は凸計画問題である．線形計画問題の最適解は，実行可能領域の多面体の頂点に存在する．この事実を確認する．
一般に多面体$X$は，すべての頂点からなる集合$V = \{\bm{v}_1, \bm{v}_2, \ldots, \bm{v}_p\}$を用いて，次のように表すことができる．
\begin{equation}
  X = \left\{\bm{x} \in \mathbb{R}^n \, | \, \bm{x} = \sum_{i = 1}^p k_i \bm{v}_i , \, \sum_{i = 1}^p k_i = 1, \, k_i \geq 0, \, i = 1, 2, \ldots, p \right\} \nonumber
\end{equation}

また，線形計画問題の目的関数は，$\bm{c}^{\mathrm{T}}\bm{x}$と表される．実行可能解$\bm{x} \in X$を考えると，$\sum_{i = 1}^p k_i = 1, \, k_i \geq 0, \, i = 1, 2, \ldots, p$を満たす$(k_1, k_2, \ldots, k_p)^{\mathrm{T}}$が存在して，
\begin{equation}
  \bm{x} = \sum_{i = 1}^p k_i \bm{v}_i \nonumber
\end{equation}
と表される．両辺に左から$\bm{c}^{\mathrm{T}}$を掛けると，
\begin{equation}
  \bm{c}^{\mathrm{T}} \bm{x} = \bm{c}^{\mathrm{T}} \left(\sum_{i = 1}^p k_i \bm{v}_i \right) = \sum_{i = 1}^p k_i \bm{c}^{\mathrm{T}} \bm{v}_i \nonumber
\end{equation}
となる．$\sum_{i = 1}^p k_i = 1, \, k_i \geq 0, \, i = 1, 2, \ldots, p$より，
\begin{equation}
  \min_{i = 1, 2, \ldots, p} \bm{c}^{\mathrm{T}} \bm{v}_i \leq \bm{c}^{\mathrm{T}} \bm{x} \leq \max_{i = 1, 2, \ldots, p} \bm{c}^{\mathrm{T}} \bm{v}_i \nonumber
\end{equation}
となる．$i = 1, 2, \ldots, p$について，$\bm{v}_i \in X$より，実行可能領域$X$での$\bm{c}^{\mathrm{T}}\bm{x}$の最大値および最小値を与える解の1つは，頂点集合$V$内にある．

\section{標準形の線形計画問題}
\subsection{線形計画問題の標準形}
変数が非負で等式制約条件しかもたない最小化問題を標準形(standard form)の線形計画問題という．すなわち，線形計画問題の標準形は，
\begin{align}\label{eq:standard}
  \mathrm{minimize} \; \; &\bm{c}^{\mathrm{T}}\bm{x} \nonumber \\
  \mathrm{subject \; to} \; \; &A\bm{x} = \bm{b} \\
  &\bm{x} \geq \bm{0} \nonumber
\end{align}
である．ただし，$\bm{c} = (c_1, c_2, \ldots, c_n)^{\mathrm{T}}, \, \bm{b} = (b_1, b_2, \ldots, b_m)^{\mathrm{T}}$はそれぞれ$n$次元，$m$次元の実数定ベクトルである．$A$は$m \times n \, (m \leq n)$の実数定行列である．$\bm{x} = (x_1, x_2, \ldots, x_n)^{\mathrm{T}}$は$n$次元の実数変数ベクトルであり，決定変数ベクトルと呼ばれる．

\subsection{標準形への変形}
\begin{description}
  \item[最大化問題の場合]
  線形計画問題が最大化問題の場合，つまり，
  \begin{equation}
    \mathrm{maximize} \; \; \bm{c}^{\mathrm{T}}\bm{x} \nonumber
  \end{equation}
  の場合，$\bm{d} = -\bm{c}$とすると，
  \begin{equation}
    \mathrm{maximize} \; \; \bm{c}^{\mathrm{T}}\bm{x} \Leftrightarrow \mathrm{minimize} \; \; \bm{d}^{\mathrm{T}}\bm{x} \nonumber
  \end{equation}
  と最小化問題に変形できる．
  \item[不等式条件$\leq$の場合]
  制約条件の1つが，
  \begin{equation}
    \bm{a}_i^{\mathrm{T}}\bm{x} \leq b_i \nonumber
  \end{equation}
  である場合，スラック変数(slack variable) $s \, (s \geq 0)$を導入して，
  \begin{equation}
    \bm{a}_i^{\mathrm{T}}\bm{x} \leq b_i \Leftrightarrow \bm{a}_i^{\mathrm{T}}\bm{x} + s = b_i, \; s \geq 0 \nonumber
  \end{equation}
  と等式条件に変形される．
  \item[不等号条件$\geq$の場合]
  制約条件の1つが，
  \begin{equation}
    \bm{a}_j^{\mathrm{T}}\bm{x} \geq b_j \nonumber
  \end{equation}
  である場合，サープラス変数(surplus variable) $t \, (t \geq 0)$を導入して，
  \begin{equation}
    \bm{a}_j^{\mathrm{T}}\bm{x} \leq b_j \Leftrightarrow \bm{a}_j^{\mathrm{T}}\bm{x} - t = b_j, \; t \geq 0 \nonumber
  \end{equation}
  と等式条件に変形される．
  \item[自由変数(非負条件の無い変数)が存在する場合]
  $x_k$に対して，$x_k \geq 0$という条件が存在せず，負の値も取る場合は，$x_k$を次の条件を満たす2つの変数$x_k^{+}$と$x_k^{-}$に分解して取り扱われる．
  \begin{equation}
    x_k = x_k^{+} - x_k^{-}, \; x_k^{+} \geq 0, x_k^{-} \geq 0 \nonumber
  \end{equation}
\end{description}

例えば，最適化問題(\ref{eq:product_plan})を標準形の線形計画問題に変形すると，(\ref{eq:product_plan_stand})になる．
\begin{align}\label{eq:product_plan_stand}
  \mathrm{minimize} \; \; &-4x_1 - 5x_2 \nonumber \\
  \mathrm{subject \; to} \; \; &2.5x_1 + 5x_2 + x_3 = 350 \nonumber \\
  &5x_1 + 6x_2 + x_4 = 450 \\
  &3x_1 + 2x_2 + x_5 = 240 \nonumber \\
  &x_1, x_2, x_3, x_4, x_5 \geq 0 \nonumber
\end{align}

\section{基底解と最適解}
\subsection{用語}
\begin{description}
  \item[基底行列]
  基底行列(basic matrix) $B$とは，制約条件の係数行列$A$の$m$個(制約条件数)の列ベクトルから作られる$m \times m$の正則行列のことをいう($|B| \neq 0$)．
  \item[基底解]
  線形計画問題の基底解(basic solution)とは，ある基底行列$B$で選ばれなかった$(n - m)$個の列に対応する変数(非基底変数(nonbasic variable))を0とおき，選ばれた$m$個の変数(基底変数(basic variable))に対する正則な連立方程式
  \begin{equation}\label{eq:basic}
    B \left(
    \begin{array}{c}
      x_1^{B} \\
      x_2^{B} \\
      \vdots \\
      x_m^{B}
    \end{array}
    \right) = \bm{b}
  \end{equation}
  を解くことにより得られる一意的なベクトル$B^{-1}\bm{b}$のことをいう．
  \item[実行可能基底解]
  実行可能解であり，基底解である解を実行可能基底解(basic feasible solution)という．基底行列を$B$とすると，$B^{-1}\bm{b} \geq \bm{0}$のときに基底行列$B$に対応する基底解は実行可能基底解となる．
  \item[退化]
  基底解では，$m$個の基底変数のみが正の値を取りうるが，この$m$個の基底変数の内少なくとも1つが0となる基底解は，退化しているという．
\end{description}

\subsection{線形計画問題の基本定理}
標準形の線形計画問題(\ref{eq:standard})において，次の定理が成立する．
\begin{theo}[線形計画問題の基本定理]\label{theo:linear_th}
  標準形の線形計画問題(\ref{eq:standard})が与えられたとき，次の1, 2が成立する．
  \begin{enumerate}
    \item 実行可能解が存在するならば，必ず実行可能基底解が存在する．
    \item 最適解が存在するならば，実行可能基底解の中に最適解が存在する．
  \end{enumerate}
\end{theo}
定理\ref{theo:linear_th}より，線形計画問題の最適解を求めるには，基底解の中で，実行可能かつ最適なものを見つければよい\footnote{実行可能領域の端点を辿っていけば最適解に到達する．後述のシンプレックス法はこの考えに基づいている．}．

\subsection{基底形式}
標準形の線形計画問題
\begin{align}\label{eq:standard_re}
  \mathrm{minimize} \; \; &z = \bm{c}^{\mathrm{T}}\bm{x} \nonumber \\
  \mathrm{subject \; to} \; \; &A\bm{x} = \bm{b} \\
  &\bm{x} \geq \bm{0} \nonumber
\end{align}
において，$m \times n$行列$A$から$m$個の列を選び基底行列$B$とする．ただし，$B$は正則行列とする．残りの列からなる行列を$N$とする．列の順番と変数の順番を適当に変えることにより，
$A = (B, N), \bm{x} = (\bm{x}_B^{\mathrm{T}}, \bm{x}_{N}^{\mathrm{T}})^{\mathrm{T}}, \bm{c} = (\bm{c}_B^{\mathrm{T}}, \bm{c}_N^{\mathrm{T}})^{\mathrm{T}}$
と表すと，式(\ref{eq:standard_re})は，
\begin{align}\label{eq:standard_re_basic}
  \mathrm{minimize} \; \; &z = \bm{c}_B^{\mathrm{T}}\bm{x}_B + \bm{c}_N^{\mathrm{T}}\bm{x}_N \nonumber \\
  \mathrm{subject \; to} \; \; &B\bm{x}_B + N\bm{x}_N = \bm{b} \\
  &\bm{x}_B, \bm{x}_N \geq \bm{0} \nonumber
\end{align}
と表される．$\bm{x}_B$は基底変数ベクトル，$\bm{x}_N$は非基底変数ベクトル，
$\bm{x}_B$の各成分$x_j^B$は基底変数，
$\bm{x}_N$の各成分$x_j^N$は非基底変数と呼ばれる．$B$は正則より，目的関数から$\bm{x}_B$を消去すると，(\ref{eq:standard_re_basic})の問題は，
\begin{align}\label{eq:standard_re_equal}
  \mathrm{minimize} \; \; &z = \bm{c}_B^{\mathrm{T}}B^{-1}\bm{b} + (\bm{c}_N^{\mathrm{T}} - \bm{c}_B^{\mathrm{T}}B^{-1}N)\bm{x}_N \nonumber \\
  \mathrm{subject \; to} \; \; &\bm{x}_B + B^{-1}N\bm{x}_N = B^{-1}\bm{b} \\
  &\bm{x}_B, \bm{x}_N \geq \bm{0} \nonumber
\end{align}
と等価になる．(\ref{eq:standard_re_equal})の一部
\begin{align}\label{eq:basic_form}
  &z = \bm{c}_B^{\mathrm{T}}B^{-1}\bm{b} + (\bm{c}_N^{\mathrm{T}} - \bm{c}_B^{\mathrm{T}}B^{-1}N)\bm{x}_N \nonumber \\
  &\bm{x}_B + B^{-1}N\bm{x}_N = B^{-1}\bm{b}
\end{align}
は，基底形式(basic form)あるいは正準形(cannoncial form)と呼ばれる．このとき，基底行列は$B$であり，対応する基底解は
\begin{equation}\label{eq:basic_sol}
  \bm{x} = \left(
  \begin{array}{c}
    \bm{x}_B \\
    \bm{x}_N
  \end{array}
  \right) = \left(
  \begin{array}{c}
    B^{-1}\bm{b} \\
    \bm{0}
  \end{array}
  \right)
\end{equation}
となる．
以後，$\bar{\bm{c}}^{\mathrm{T}} = \bm{c}_N^{\mathrm{T}} - \bm{c}_B^{\mathrm{T}}B^{-1}N, \, \bar{N} = B^{-1}N, \, \bar{\bm{b}} = B^{-1}\bm{b}$と定める．
また，$\bar{\bm{c}}, \, \bar{N}, \, \bar{\bm{b}}$の各成分をそれぞれ，
$\bar{c}_{j}, \, \bar{a}_{ij}, \, \bar{b}_i$と表す．

(\ref{eq:basic_form})式を$\bar{\bm{c}}, \bar{N}, \bar{\bm{b}}$を用いて表すと，
\begin{align}\label{eq:basic_form_re}
  &z = \bm{c}_B^{\mathrm{T}}\bar{\bm{b}} + \bar{\bm{c}}^{\mathrm{T}}\bm{x}_N \nonumber \\
  &\bm{x}_B + \bar{N}\bm{x}_N = \bar{\bm{b}}
\end{align}
となる．(\ref{eq:standard_re_equal})式において，
\begin{equation}\label{eq:feasible_b}
  \bar{\bm{b}} = B^{-1}\bm{b} \geq \bm{0} \; \; (実行可能性)
\end{equation}
が成立すれば，(\ref{eq:basic_sol})式の基底解は実行可能解となる．(\ref{eq:feasible_b})が満たされると仮定する．

基底形式(\ref{eq:basic_form})のある非基底変数$x_r^N$の係数$\bar{c}_r$が負であれば，この非基底変数に正の値を取らせることにより，目的関数が改善できる\footnote{$\bar{c}_r < 0$ならば，$x_r^N > 0$を取ることで，実行可能性を維持したまま(\ref{eq:basic_form})式の$z$の値を小さくすることができる．}．逆に，すべての非基底変数$x_j^N$の係数$\bar{c}_j$が正，すなわち，
\begin{equation}\label{eq:opt_con}
  \bar{\bm{c}}^{\mathrm{T}} = \bm{c}_N^{\mathrm{T}} - \bm{c}_B^{\mathrm{T}}B^{-1}N \geq \bm{0}^{\mathrm{T}} \; \; (最適性)
\end{equation}
が成立すれば，この実行可能基底解は最適解の1つである．

次に，$\bar{c}_r$が負であるとき，実行可能性を維持する，つまり，$x_r^N$に正の値を取らせることが可能であるかどうかを考える．ここで，$x_r^N$以外の非基底変数$x_j^N$の値を0に固定する．このとき，
\begin{equation}\label{eq:x_B}
  \bm{x}_B = \bar{\bm{b}} -
  \left(
  \begin{array}{c}
    \bar{a}_{1r} \\
    \bar{a}_{2r} \\
    \vdots \\
    \bar{a}_{mr}
  \end{array}
  \right)x_r^N
\end{equation}
を満たせば，制約条件の最初の等式条件$\bm{x}_B + \bar{N}\bm{x}_N = \bar{\bm{b}}$を満足する．
実際，$\bm{x}_N = \left(0, \cdots, x_r^N, \cdots, 0 \right)^{\mathrm{T}}$
のとき，
\begin{equation}
  \bar{N} \bm{x}_N = \left(
  \begin{array}{ccccc}
    \bar{a}_{11} & \cdots & \bar{a}_{1r} & \cdots & \bar{a}_{1 n-m} \\
    \vdots & \ddots & \vdots & \ddots & \vdots \\
    \bar{a}_{m1} & \cdots & \bar{a}_{mr} & \cdots & \bar{a}_{m n-m}
  \end{array}
  \right) \left(
  \begin{array}{c}
    0 \\
    \vdots \\
    x_r^N \\
    \vdots \\
    0
  \end{array}
  \right) = \left(
  \begin{array}{c}
    \bar{a}_{1r} \\
    \bar{a}_{2r} \\
    \vdots \\
    \bar{a}_{mr}
  \end{array}
  \right)x_r^N \nonumber
\end{equation}
を満たす．さらに，非負条件を満たすには，$\bm{x}_B \geq \bm{0}$より，
\begin{equation}\label{eq:notminus}
  \bar{\bm{b}} -
  \left(
  \begin{array}{c}
    \bar{a}_{1r} \\
    \bar{a}_{2r} \\
    \vdots \\
    \bar{a}_{mr}
  \end{array}
  \right)x_r^N \geq \bm{0}
\end{equation}
が成立すればよい．もし，
\begin{equation}\label{eq:a_minus}
  \left(
  \begin{array}{c}
    \bar{a}_{1r} \\
    \bar{a}_{2r} \\
    \vdots \\
    \bar{a}_{mr}
  \end{array}
  \right) \leq \bm{0}
\end{equation}
が成立すれば，(\ref{eq:notminus})式より，実行可能性を損なうことなく$x_r^N$をいくらでも正に大きくすることができる．このとき，目的関数値をいくらでも小さくすることができるので，この解は非有解(unbounded solution)である．すなわち，最適解は存在しない．

一方，(\ref{eq:a_minus})式が成立しない場合，$\bar{a}_{ir}$のいくつかは正となる．(\ref{eq:notminus})式を満たすには，$\bar{a}_{ir} > 0$なるすべての$i \in \{1, 2, \ldots, m\}$に対して，
\begin{equation}\label{eq:bax}
  \bar{b}_i - \bar{a}_{ir} x_r^N \geq 0
\end{equation}
を満たせばよい．すなわち，
\begin{equation}\label{eq:min_a}
  x_r^N \leq \min_{i: \, \bar{a}_{ir} > 0} \frac{\bar{b}_i}{\bar{a}_{ir}}
\end{equation}
を満たせばよい．いま，$\bar{c_r} < 0$を考えているので，$x_r^N$が大きいほど目的関数値が小さくなる．よって，
\begin{equation}\label{eq:min_a_eq}
  x_r^N = \min_{i: \, \bar{a}_{ir} > 0} \frac{\bar{b}_i}{\bar{a}_{ir}}
\end{equation}
とおくと，現在の実行可能基底解よりも目的関数値が小さい実行可能解が得られる．右辺の最小値を与える$i$を$s$とおく，つまり，(\ref{eq:min_a_eq})式を満たす$i$を$i = s$とすると，$\bm{x}_B$の$s$番目の成分$x_s^B$の値は，(\ref{eq:x_B})式より，
\begin{equation}
  x_s^B = \bar{b}_s - \bar{a}_{sr} x_r^N = \bar{b}_s - \bar{a}_{sr} \min_{i: \, \bar{a}_{ir} > 0} \frac{\bar{b}_i}{\bar{a}_{ir}} = \bar{b}_s - \bar{a}_{sr} \frac{\bar{b}_s}{\bar{a}_{sr}} = 0
\end{equation}
となる．すなわち，基底変数$x_s^B$を非基底変数$x_r^N$で入れ替えた実行可能基底解に対応する．したがって，この入れ替えを行った基底形式を求め，同様の議論を続けていけば，最適解が見つかるか，もしくは非有界であるかがわかる．この基底の入れ替えを行った後の基底形式を(\ref{eq:standard_re_equal})式から求める計算法を与えるのがピボット演算である．

\subsection{ピボット演算}
(\ref{eq:standard_re_equal})式に対応する基底形式(\ref{eq:basic_form})は，$\bar{z} = \bm{c}_B^{\mathrm{T}}B^{-1}\bm{b}$とすると，次のように書き換えられる．
\begin{align}
  &z = \bar{z} + \left(
  \begin{array}{ccc}
    \bar{c}_1 & \cdots & \bar{c}_{n - m}
  \end{array}
  \right) \left(
  \begin{array}{c}
    x_1^N \\
    \vdots \\
    x_{n-m}^N
  \end{array}
  \right) \nonumber \\
  &\left(
  \begin{array}{c}
    x_1^B \\
    \vdots \\
    x_m^B
  \end{array}
  \right) + \left(
  \begin{array}{ccc}
    \bar{a}_{11} & \cdots & \bar{a}_{1 n-m} \\
    \vdots & & \vdots \\
    \bar{a}_{m1} & \cdots & \bar{a}_{m n-m}
  \end{array}
  \right) \left(
  \begin{array}{c}
    x_1^N \\
    \vdots \\
    x_{n-m}^N
  \end{array}
  \right) = \left(
  \begin{array}{c}
    \bar{b}_1 \\
    \vdots \\
    \bar{b}_m
  \end{array}
  \right) \nonumber
\end{align}
つまり，
\begin{equation}
    \begin{alignedat}{9}
      x_1^B \; &          & &           & &          & &+\bar{a}_{11}x_1^N & &+\bar{a}_{12}x_2^N & &+\cdots & &+\bar{a}_{1 n-m}x_{n-m}^N & &= \; & &\bar{b}_1   \\
               & x_2^B \; & &           & &          & &+\bar{a}_{21}x_1^N & &+\bar{a}_{22}x_2^N & &+\cdots & &+\bar{a}_{2 n-m}x_{n-m}^N & &= \; & &\bar{b}_2   \\
               &          & & \ddots \; & &          & &                   & &\cdots             & &\cdots  & &\cdots                    & &     & & \\
               &          & &           & & x_m^B \; & &+\bar{a}_{m1}x_1^N & &+\bar{a}_{m2}x_2^N & &+\cdots & &+\bar{a}_{m n-m}x_{n-m}^N & &= \; & &\bar{b}_m  \\
               &          & &           & & -z \;    & &+\bar{c}_{1}x_1^N  & &+\bar{c}_{2}x_2^N  & &+\cdots & &+\bar{c}_{n-m}x_{n-m}^N   & &= \; & &-\bar{z}
    \end{alignedat}
\end{equation}
のように書き換えられる．ピボット演算は次の手順で行われる．ただし，$s$は(\ref{eq:min_a_eq})式を満たす$i$であり，$r$は基底形式(\ref{eq:basic_form})の係数ベクトル$\bar{\bm{c}} = \bm{c}_N^{\mathrm{T}} - \bm{c}_B^{\mathrm{T}}B^{-1}N$のうち，負の値を取る要素$\bar{c_r}$の添字である．
\begin{itembox}[l]{ピボット操作}
  \begin{description}
    \item[手順1] $s$行を$\bar{a}_{sr}$で割る．
    \item[手順2] 目的関数の行も含め，$i$行$j$列の元の係数$d_{ij}^{old}$，新しい係数を$d_{ij}^{new}$とすると，$i \neq s$に対して，
    \begin{equation}
      d_{ij}^{new} = d_{ij}^{old} - d_{sj}^{old} \frac{\bar{a}_{ir}}{\bar{a}_{sr}} \nonumber
    \end{equation}
    と更新する．
  \end{description}
\end{itembox}

つまり，ピボット演算は$s$行$r$列の値を1に，$r$列の他の行の値が$0$になるように等価変換することに相当する．

\section{シンプレックス法}
線形計画問題を解くアルゴリズムであるシンプレックス法(simplex method)の基本形を与える．このアルゴリズムは，制約条件が定める凸多面体$X$の頂点(実行可能基底解)の1つから出発し，それに隣接する頂点の中でより目的関数値を小さくするものへ移動するという操作を反復して，最終的に最適解である頂点の1つに到達するか，あるいは発散を結論するアルゴリズムである．シンプレックス法は単体法とも呼ばれる．以下にシンプレックス法の手順を示す．

\begin{itembox}[l]{アルゴリズム SIMPLEX}
  \begin{description}
    \item[Input] 標準形の問題(\ref{eq:standard_re})．ただし，$\bm{b} \geq \bm{0}$を仮定し，(\ref{eq:standard_re_equal})に等価変換する．
    \item[Output] 最適解$\bar{\bm{x}}$，あるいは「発散」の結論．
  \end{description}
  \begin{enumerate}
    \item 初期実行可能基底解$\bm{x}^{0}$を求める．$k \leftarrow 0$．
    \item $\bar{\bm{c}}^{\mathrm{T}} \coloneqq \bm{c}_N^{\mathrm{T}} - \bm{c}_B^{\mathrm{T}}B^{-1}N$によって得られる$\bar{\bm{c}}$の要素$\bar{c}_j$を用いて，
    \begin{equation}
      \min_{1 \leq j \leq n - m} \bar{c}_j = \bar{c}_r \nonumber
    \end{equation}
    となる$r$を1つ選ぶ．$\bar{c}_r \geq 0$であれば，$\bar{\bm{x}} \leftarrow \bm{x}^k$として計算終了．\label{enu:roop}
    \item $\bar{N} \coloneqq B^{-1}N (=(\bar{a}_{ij}))$に対して，第$r$列のすべての成分$\bar{a}_{ir}$が$\bar{a}_{ir} \leq 0$であれば，最小値が有界でない(問題が発散する)ことを結論して計算終了．
    \item $\bar{a}_{ir}$に正のものがあれば，
    \begin{equation}
      \min_{i: \, \bar{a}_{ir} > 0} \frac{\bar{b}_i}{\bar{a}_{ir}} = \frac{\bar{b}_s}{\bar{a}_{sr}} \nonumber
    \end{equation}
    となる$s$を1つ選ぶ．
    \item $\bar{a}_{sr}$に対するピボット操作により$x_s^B$の代わりに$x_r^N$を基底変数とする新しい実行可能基底解$\bm{x}^{k + 1}$を求める．$k \leftarrow k + 1$として\ref{enu:roop}.に戻る．
  \end{enumerate}
\end{itembox}
通常，シンプレックスタブローを用いて問題(\ref{eq:standard_re})を解く．最適化問題(\ref{eq:product_plan_stand})を例に説明する．表\ref{tab:product_plan_sol}に問題(\ref{eq:product_plan_stand})のシンプレックスタブローを示す．

\begin{table}[htb]
  \centering
    \caption{シンプレックスタブロー}
    \begin{tabular}{c|c|ccccc|c}
    サイクル & 基底   & $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & 右辺  \\ \hline
            & $x_3$ & $2.5$ & [$5$] & $1$   &       &       & $350$ \\
       0    & $x_4$ & $5$   & $6$   &       & $1$   &       & $450$ \\
            & $x_5$ & $3$   & $2$   &       &       &  $1$  & $240$ \\ \cline{2-8}
            & $-z$  & $-4$  & $-5$  &       &       &       & $0$   \\ \hline

            & $x_2$ & $0.5$ & $1$   & $0.2$ &       &       & $70$  \\
       1    & $x_4$ & [$2$] &       & $-1.2$& $1$   &       & $30$  \\
            & $x_5$ & $2$   &       & $-0.4$&       &  $1$  & $100$ \\ \cline{2-8}
            & $-z$  & $-1.5$&       & $1$   &       &       & $350$ \\ \hline

            & $x_2$ &       & $1$   & $-0.1$&$-0.25$&       & $62.5$\\
       2    & $x_1$ & $1$   &       & $-0.6$& $0.5$ &       & $15$  \\
            & $x_5$ &       &       & $0.8$ &$-0.5$ &  $1$  & $70$  \\ \cline{2-8}
            & $-z$  &       &       & $0.1$ & $0.75$&       &$372.5$\\ \hline
    \end{tabular}
    \label{tab:product_plan_sol}
\end{table}

最適化問題(\ref{eq:product_plan_stand})において，決定変数ベクトルを$\bm{x} = (x_1, x_2, x_3, x_4, x_5)^{\mathrm{T}} \geq \bm{0}$
とする．さらに，
\begin{equation}
  A = \left(
  \begin{array}{ccccc}
    2.5 & 5 & 1 & 0 & 0 \\
    5   & 6 & 0 & 1 & 0 \\
    3   & 2 & 0 & 0 & 1 \\
  \end{array}
  \right), \; \bm{b} = \left(
  \begin{array}{c}
    350 \\
    450 \\
    240
  \end{array}
  \right), \; \bm{c} = \left(
  \begin{array}{c}
    -4 \\
    -5
  \end{array}
  \right) \nonumber
\end{equation}
とする．

サイクル0では，基底変数ベクトルを$\bm{x}_B = (x_3, x_4, x_5)^{\mathrm{T}}$，非基底変数ベクトルを
$\bm{x}_N = (x_1, x_2)^{\mathrm{T}}$としている．ただし，(\ref{eq:standard_re_basic})における$B$行列，$N$行列はそれぞれ，
\begin{equation}
  B = \left(
  \begin{array}{ccc}
    1 & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1
  \end{array}
  \right), \; N = \left(
  \begin{array}{cc}
    2.5 & 5 \\
    5   & 6 \\
    3   & 2
  \end{array}
  \right) \nonumber
\end{equation}
である．また，初期実行可能基底解は，$\bm{x}^0 = (x_1, x_2, x_3, x_4, x_5)^{\mathrm{T}} = (0, 0, 350, 450, 240)^{\mathrm{T}}$である．$k \leftarrow 0$とする．
$\bar{\bm{c}}^{\mathrm{T}} = (-4, -5)$であり，
\begin{equation}
  \min_{1 \leq j \leq 2} \bar{c}_{j} = -5 = \bar{c}_2 \nonumber
\end{equation}
より，$r = 2$．$\bar{N} = B^{-1}N (= N)$の第$2$列の成分$\bar{a}_{i2}$のうち，
\begin{equation}
  \min_{i: \, \bar{a}_{i2} > 0} \frac{\bar{b}_i}{\bar{a}_{i2}} =  70 = \frac{\bar{b}_1}{\bar{a}_{12}} \nonumber
\end{equation}
より，$s = 1$．$\bar{a}_{12}$に対するピボット操作をし，非基底変数$x_2$を基底変数とする．
実行可能基底解は，$\bm{x}^1 = (x_1, x_2, x_3, x_4, x_5)^{\mathrm{T}} = (0, 70, 0, 30, 100)^{\mathrm{T}}$である．$k \leftarrow 1$とする．サイクル1,2についても同様である．サイクル2では$\bar{c}_1 = 0.1 > 0$より，最適解は
$\bar{\bm{x}} = \bm{x}^{2} = (\bar{x}_1, \bar{x}_2, \bar{x}_3, \bar{x}_4, \bar{x}_5)^{\mathrm{T}} = (15, 62.5, 0, 0, 70)^{\mathrm{T}}$である．また，最適値は$-372.5$である．

\section{2段階法}
上述のシンプレックス法では，実行可能基底解が得られてから最適解を得ることができる．しかし，初期実行可能基底解の求め方については述べていない．さらに，問題によっては$A$行列がランク落ちしている場合や実行可能解が存在しない場合もあり，問題が与えられても直ちにシンプレックス法を適用できるとは限らない．

これらの問題点を克服する方法として，罰金法(penalty method)と2段階法(two phase method)がある．以下では2段階法について説明する．以後，線形計画問題(\ref{eq:standard_re})の制約条件の右辺値$b_i, \, i = 1, 2, \ldots, m$がすべて非負であると仮定する．そうでなければ，両辺を$(-1)$倍すればよい．

2段階法では，線形計画問題(\ref{eq:standard_re})の各制約条件の左辺に非負の人為変数$\mu_i$を加える．まず，実行可能性をテストする問題を解いた後に，続けて求められた実行可能基底解を用いて線形計画問題(\ref{eq:standard_re})をシンプレックス法で解く2段階の解法である．

線形計画問題(\ref{eq:standard_re})の実行可能性をテストする問題は，
\begin{align}\label{eq:test}
  \mathrm{minimize} \; \; &w = \sum_{i = 1}^m \mu_i \nonumber \\
  \mathrm{subject \; to} \; \; &A\bm{x} + \left(
  \begin{array}{c}
    \mu_1 \\
    \mu_2 \\
    \vdots \\
    \mu_m
  \end{array}
  \right) = \bm{b} \\
  &\bm{x} \geq \bm{0}, \; \mu_i \geq 0, \; i = 1, 2, \ldots, m \nonumber
\end{align}
と書ける．線形計画問題(\ref{eq:standard_re})に実行可能解が存在すれば，この問題(\ref{eq:test})の最適値が$0$となる．逆に，問題(\ref{eq:test})の最適値が$0$となれば，線形計画問題(\ref{eq:standard_re})に実行可能基底解が存在する．線形計画問題(\ref{eq:test})において，初期実行可能解を
\begin{equation}\label{eq:sol_f}
  (x_1, x_2, \ldots, x_n, \mu_1, \mu_2, \ldots, \mu_m)^{\mathrm{T}} = (0, 0, \ldots, 0, b_1, b_2, \ldots, b_m)^{\mathrm{T}}
\end{equation}
としてシンプレックス法を適用する．問題(\ref{eq:test})の最適値が$0$であれば，$\mu_i = 0, \, i = 1, 2, \ldots, m$であるので，得られた最適解は元の線形計画問題の実行可能解である．

このとき，
\begin{enumerate}
  \renewcommand{\labelenumi}{(\alph{enumi})}
  \item $\mu_i = 0, \, i = 1, 2, \ldots, m$がすべて非基底変数．
  \item $\mu_i$のいずれかは基底変数であるがその値が$0$となり退化している．
\end{enumerate}
の2通りが考えられる．

(a)の場合，変数$\mu_i, \, i = 1, 2, \ldots, m$の関与する部分をすべて取り去れば，得られた最適解は元の問題(\ref{eq:standard_re})の実行可能基底解となる．つまり，基底形式が得られ，シンプレックス法により元の線形計画問題(\ref{eq:standard_re})の最適解を計算することができる．

(b)の場合，求められた最適基底解のうち，$\mu_i$が基底に入り，その変数値が$0$となっている場合は，問題(\ref{eq:test})の得られた最適解の基底形式の目的関数の係数が正となっている非基底変数を$0$で固定しなければならない\footnote{この非基底変数が正の値を取れば，問題(\ref{eq:test})の目的関数値が正となり，問題(\ref{eq:standard_re})の実行可能解ではなくなるから．}．
非基底変数を$0$で固定するには，これらの変数に関わる部分を以後削除すればよい．

ここで，$\hat{\bm{y}} = (\bm{x}^{\mathrm{T}}, \mu_1, \mu_2, \ldots, \mu_m)^{\mathrm{T}}, \,
\hat{\bm{c}} = (\bm{c}^{\mathrm{T}}, 0, \ldots, 0)^{\mathrm{T}}, \,
\hat{\bm{d}} = (\bm{0}^{\mathrm{T}}, 1, \ldots, 1)^{\mathrm{T}}, \,
\hat{A} = (A, I)$($I$は単位行列)と定めると，2段階法の手順は次のように統一的に記述される．

\begin{itembox}[l]{アルゴリズム 2PHASE\_SIMPLEX}
  \begin{description}
    \item[Input] 標準形の問題(\ref{eq:standard_re})．ただし，$b_i, \, i = 1, 2, \ldots, m$をがすべて非負であることを仮定する(そうでなければ両辺を$-1$倍する)．
    \item[Output] 最適解$\bar{\bm{x}}$，あるいは「実行不能」または「発散」の結論．
  \end{description}
  \begin{enumerate}
    \item $\hat{\bm{y}}^0 = (\bm{0}^{\mathrm{T}},\bm{b}^{\mathrm{T}})^{\mathrm{T}}$初期実行可能基底解として，シンプレックス法により，次の線形計画問題の最適解を求める．
    \begin{align}\label{eq:test_two}
      \mathrm{minimize} \; \; &w = \hat{\bm{d}}^{\mathrm{T}} \hat{\bm{y}} \nonumber \\
      \mathrm{subject \; to} \; \; &\hat{A}\hat{\bm{y}} = \bm{b} \\
      &\hat{\bm{y}} \geq \bm{0} \nonumber
    \end{align}
    \item 問題(\ref{eq:test_two})の最適値が正の値であれば，元の線形計画問題に実行可能解は存在しない．実行不能であることを結論して計算終了．
    \item 問題(\ref{eq:test_two})の最適値が$0$であれば，得られた最適基底解に対応する基底形式
    \begin{align}\label{eq:two_basic}
      &w = 0 + (\hat{\bm{d}}_N^{\mathrm{T}} - \hat{\bm{d}}_B^{\mathrm{T}}\bar{\hat{N}}) \hat{\bm{y}}_N \nonumber \\
      &\hat{\bm{y}}_B + \bar{\hat{N}}\hat{\bm{y}}_N = \bar{\bm{b}}
    \end{align}
    を考え，$n$次元ベクトル$\bar{\hat{\bm{d}}}_N = (\bar{\hat{d}}_1, \bar{\hat{d}}_2, \ldots, \bar{\hat{d}}_n)^{\mathrm{T}} = (\hat{\bm{d}}_N^{\mathrm{T}} - \hat{\bm{d}}_B^{\mathrm{T}}\bar{\hat{N}})^{\mathrm{T}}$
    を定める．$\bar{\hat{d}}_j > 0$であれば，対応する変数$\hat{y}_j^N$を以後無視する．また，
    $\hat{y}_j, \, j = n, n+1, n+2, \ldots, n+m$の中で非基底変数であるものも以後無視する．
    \item 目的関数の係数ベクトルを$\hat{\bm{c}}$に変更した基底形式
    \begin{align}\label{eq:two_basic_change}
      &z = 0 + (\hat{\bm{c}}_N^{\mathrm{T}} - \hat{\bm{c}}_B^{\mathrm{T}}\bar{\hat{N}}) \hat{\bm{y}}_N \nonumber \\
      &\hat{\bm{y}}_B + \bar{\hat{N}}\hat{\bm{y}}_N = \bar{\bm{b}}
    \end{align}
    を求め，無視するすべての変数の列を削除して，SIMPLEXを実行する．
    \item SIMPLEXの\ref{enu:roop}.で終了すれば，元の問題(\ref{eq:standard_re})は非有界となる(発散する)ことを結論して計算終了．
    そうでなければ，最適解が得られる．このとき，無視された変数は非基底変数として扱われ，$\hat{\bm{y}}$の最初の$n$個の変数の値で構成されるベクトルが元の問題(\ref{eq:standard_re})の最適解となる．
  \end{enumerate}
\end{itembox}

ここで，次の例題を解く．
\begin{align}\label{eq:twophase_ex}
  \mathrm{minimize} \; \; &z = 9x_1 + 5x_2 + 8x_3 \nonumber \\
  \mathrm{subject \; to} \; \; &2.5x_1 + 3x_2 + 5x_3 - x_4 = 200 \nonumber \\
  &2.5x_1 + 2x_2 + 3x_3 - x_5 = 160 \\
  &3x_1 + x_2 + 2x_3 - x_6 = 120 \nonumber \\
  &x_1, x_2, x_3, x_4, x_5, x_6 \geq 0 \nonumber
\end{align}

問題(\ref{eq:twophase_ex})の実行可能性をテストする問題(第1段階の問題)は，
\begin{align}\label{eq:twophase_ex_test}
  \mathrm{minimize} \; \; &w = \mu_1 + \mu_2 + \mu_3 \nonumber \\
  \mathrm{subject \; to} \; \; &2.5x_1 + 3x_2 + 5x_3 - x_4 + \mu_1 = 200 \nonumber \\
  &2.5x_1 + 2x_2 + 3x_3 - x_5 + \mu_2 = 160 \\
  &3x_1 + x_2 + 2x_3 - x_6 + \mu_3 = 120 \nonumber \\
  &x_1, x_2, x_3, x_4, x_5, x_6, \mu_1, \mu_2, \mu_3 \geq 0 \nonumber
\end{align}
である．第1段階のシンプレックスタブローを表\ref{tab:twophase_phase1}に示す．

\begin{table}[htb]
  \centering
    \caption{シンプレックスタブロー(第1段階)}
    \begin{tabular}{c|c|cccccc|c}
    サイクル & 基底     & $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & 右辺  \\ \hline
            & $\mu_1$ & $2.5$ & $3$   & [$5$] & $-1$  &       &       & $200$ \\
       0    & $\mu_2$ & $2.5$ & $2$   & $3$   &       & $-1$  &       & $160$ \\
            & $\mu_3$ & $3$   & $1$   & $2$   &       &       & $-1$  & $120$ \\ \cline{2-9}
            & $-w$    & $-8$  & $-6$  & $-10$ & $1$   & $1$   & $1$   & $-480$\\ \hline

            & $x_3$   & $0.5$ & $0.6$ & $1$   & $-0.2$&       &       & $40$ \\
       1    & $\mu_2$ & $1$   & $0.2$ &       & $0.6$ & $-1$  &       & $40$ \\
            & $\mu_3$ & [$2$] & $-0.2$&       &  $0.4$&       & $-1$  & $40$ \\ \cline{2-9}
            & $-w$    & $-3$  &       &       & $-1$  & $1$   & $1$   & $-80$\\ \hline

            & $x_3$   &       & $0.65$& $1$   & $-0.3$&       & $0.25$& $30$ \\
       2    & $\mu_2$ &       & $0.3$ &       & $0.4$ & $-1$  &[$0.5$]& $20$ \\
            & $x_1$   & $1$   & $-0.1$&       &  $0.2$&       & $-0.5$& $20$ \\ \cline{2-9}
            & $-w$    &       & $-0.3$&       & $-0.4$& $1$   & $-0.5$& $-20$\\ \hline

            & $x_3$   &       & $0.5$ & $1$   & $-0.5$& $0.5$ &       & $20$ \\
       3    & $x_6$   &       & $0.6$ &       & $0.8$ & $-2$  &$1$    & $40$ \\
            & $x_1$   & $1$   & $0.2$ &       &  $0.6$&  $-1$ &       & $40$ \\ \cline{2-9}
            & $-w$    &       &       &       &       &       &       & $0$  \\ \hline
    \end{tabular}
    \label{tab:twophase_phase1}
\end{table}

第1段階の問題(\ref{eq:twophase_ex_test})の最適値が$0$より，元の問題(\ref{eq:twophase_ex})は実行可能であり，問題(\ref{eq:twophase_ex_test})の最適解
$(x_1, x_2, x_3, x_4, x_5, x_6)^{\mathrm{T}} = (40, 0, 20, 0, 0, 40)^{\mathrm{T}}$
を初期実行可能基底解として解くことができる．
基底変数は$x_1, x_3, x_6$であり，目的関数を非基底変数のみを含む式に書き直すと，
\begin{equation}\label{eq:two_obj}
  z = 520 - 0.8 x_2 - 1.4 x_4 + 5 x_5
\end{equation}
である\footnote{
シンプレックスタブローより，
\begin{align}
  x_1 + 0.2 x_2 + 0.6 x_4 - x_5 = 40 \; \; \therefore x_1 = 40 - 0.2 x_2 - 0.6 x_4 + x_5 \nonumber \\
  0.5 x_2 + x_3 - 0.5 x_4 + 0.5 x_5 = 20 \; \; \therefore x_3 = 20 - 0.5 x_2 + 0.5 x_4 - 0.5 x_5 \nonumber
\end{align}
なので，
\begin{align}
  z &= 9x_1 + 5x_2 + 8x_3 \nonumber \\
  &= 9(40 - 0.2x_2 - 0.6x_4 + x_5) + 5x_2 + 8(20 - 0.5 x_2 + 0.5 x_4 - 0.5 x_5) \nonumber \\
  &= 520 - 0.8 x_2 - 1.4 x_4 + 5 x_5 \nonumber
\end{align}
}．

\begin{table}[htb]
  \centering
    \caption{シンプレックスタブロー(第2段階)}
    \begin{tabular}{c|c|cccccc|c}
    サイクル & 基底     & $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & 右辺  \\ \hline
            & $x_3$   &       & $0.5$ & $1$   & $-0.5$& $0.5$ &       & $20$ \\
$0^{\prime}$& $x_6$   &       & $0.6$ &       &[$0.8$]& $-2$  &$1$    & $40$ \\
            & $x_1$   & $1$   & $0.2$ &       &  $0.6$&  $-1$ &       & $40$ \\ \cline{2-9}
            & $-z$    &       & $-0.8$&       & $-1.4$& $5$   &       & $-520$  \\ \hline

            & $x_3$   &       &$0.875$& $1$   &       &$-0.75$&$0.625$& $45$ \\
$1^{\prime}$& $x_4$   &       & $0.75$&       & $1$   & $-2.5$&$1.25$ & $50$ \\
            & $x_1$   & $1$   &$-0.25$&       &       & $-0.5$&$-0.75$& $10$ \\ \cline{2-9}
            & $-z$    &       & $0.25$&       &       & $0.15$& $1.75$& $-450$  \\ \hline
    \end{tabular}
    \label{tab:twophase_phase2}
\end{table}

第2段階のタブローを表\ref{tab:twophase_phase2}に示す．タブローより，最適解は
$(\bar{x}_1, \bar{x}_2, \bar{x}_3, \bar{x}_4, \bar{x}_5, \bar{x}_6)^{\mathrm{T}}
= (10, 0, 45, 0, 50, 0)^{\mathrm{T}}$であり，最適値は$450$である．

\section{シンプレックス法の収束性}
シンプレックス法は，退化が起こらないという仮定の下では，有限回の反復で最適解に到達することが示されており，多くの場合最適解を見つけることができる．しかし，この仮定が成立しない場合には，有限回の反復で最適解が求められるとは限らない．シンプレックス法のサイクルを繰り返すだけで最適解が求まらないような現象を巡回(cycling)という\footnote{目的関数値が変化しない．}．巡回が起こる場合，次のBlandの巡回対策を用いて巡回から抜け出し，最適解を求めることができる．

\begin{itembox}[l]{Blandの巡回対策を含めたアルゴリズム SIMPLEX}
  \begin{description}
    \item[Input] 標準形の問題(\ref{eq:standard_re})．ただし，$\bm{b} \geq \bm{0}$を仮定し，(\ref{eq:standard_re_equal})に等価変換する．
    \item[Output] 最適解$\bar{\bm{x}}$，あるいは「発散」の結論．
  \end{description}
  \begin{description}
    \item[1] 初期実行可能基底解$\bm{x}^{0}$を求める．$k \leftarrow 0$．
    \item[2B] $\bar{\bm{c}}^{\mathrm{T}} \coloneqq \bm{c}_N^{\mathrm{T}} - \bm{c}_B^{\mathrm{T}}B^{-1}N$によって得られる$\bar{\bm{c}}$の要素$\bar{c}_j$を用いて，
    \begin{equation}
      \min \{j \, | \, \bar{c}_j\} = r \nonumber
    \end{equation}
    となる$r$を求める．

    つまり，$\bar{c}_j < 0$であるような$j$が2個以上存在するとき，添字$j$の値が最小のものを$r$とする．すべての$\bar{c}_j$が
    $\bar{c}_j \geq 0$であれば，$\bar{\bm{x}} \leftarrow \bm{x}^k$として計算終了．
    \item[3] $\bar{N} \coloneqq B^{-1}N (=(\bar{a}_{ij}))$に対して，第$r$列のすべての成分$\bar{a}_{ir}$が$\bar{a}_{ir} \leq 0$であれば，最小値が有界でない(問題が発散する)ことを結論して計算終了．
    \item[4B] $\bar{a}_{ir}$に正のものがあれば，
    \begin{equation}
      \min_{i: \, \bar{a}_{ir} > 0} \frac{\bar{b}_i}{\bar{a}_{ir}} = \frac{\bar{b}_s}{\bar{a}_{sr}} \nonumber
    \end{equation}
    となる$s$を求める．

    ただし，最小値を与える$i$が2つ以上存在するとき，添字$i$の値が最小のものを$s$とする．
    \item[5] $\bar{a}_{sr}$に対するピボット操作により$x_s^B$の代わりに$x_r^N$を基底変数とする新しい実行可能基底解$\bm{x}^{k + 1}$を求める．$k \leftarrow k + 1$として2Bに戻る．
  \end{description}
\end{itembox}

Blandの巡回対策を用いると巡回から抜け出すことができる．
\begin{theo}\label{theo:bland}
  手順2Bで$r$を決定し，手順4Bで$s$を決定するとき，SIMPLEXは有限回の反復で終了する．
\end{theo}

通常のシンプレックス法での列の選び方は，目的関数値の改善割合が大きい変数を基底に入れ，値を取らせることでより早く最適解に到達するだろうというヒューリスティックに基づいていた．このヒューリスティックは有効だが，巡回に陥り最適解が求まらないことがある．
一方，Blandの巡回対策では，巡回することはないと保証されているが，効率的ではない．
現実には，通常のシンプレックス法で開始し，目的関数が一定回数変化しなければ，Blandの巡回対策に切り替え，目的関数が変化すればもとの方法に戻すといった方法がとられることが多い．


\end{document}
